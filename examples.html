<!DOCTYPE html 
PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd>
<html>
<head>
<title>Thermolab - Thermodynamics laboratory</title>
  <meta name="description" content="Thermolab, geology, fluids, numerical modelling, modeling, thermodynamics, pressure variations">
  <meta name="keywords" content="Thermolab, geology, fluids, numerical modelling, modeling, thermodynamics, pressure variations">
  <meta name="keyphrases" content="Thermolab, geology, fluids, numerical modelling, modeling, thermodynamics, pressure variations">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" href="my_style.css" type="text/css" />
</head>
<body>
<div id="header">
    <ul>
        <li><a href="https://hansjcv.github.io/Thermolab/"><strong>Thermolab:</strong></a></li>
        <li><a href="https://doi.org/10.1029/2021GC010303"><strong>A thermodynamics Laboratory for</strong></a></li>
        <li><a href="https://doi.org/10.1029/2021GC010303"><strong>Nonlinear Transport Processes in Open Systems</strong></a></li>
    </ul>
</div>
<div id="menu">
    <ul>
        <li><a href="index.html">Home</a></li>
        <li><a href="setup.html">Setup</a></li>
        <li><a href="examples.html" class="selected">Examples</a></li>
        <!--	<li><a href="publications.html">Publications</a></li>
    <li><a href="updates.html">Updates</a></li>
    <li><a href="contact.html">Contact</a></li>-->
    </ul>
</div>

<div id="maincontent">
    <h1>Example 1</h1>
    <p>
        <a href="Example_01.m"> <img src="Example_1.PNG" alt="Code" width="100%" style="border:1px solid #ff0000" /></a>
    </p>
    <ul>
        <li>Line 1 clears the Matlab memory and adds a folder to the MATLAB path. In this case the relative path: one level up in the folder structure. It can also be a complete path to the folder in which the main Thermolab functions are stored.</li>
        <li>Line 2 defines the temperature in Kelvin.</li>
        <li>Line 3 defines the pressure in Pascal.</li>
        <li>Line 4 specifies the phase for which the Gibbs energy will be calculated. It uses the abbreviation of the phase in a thermodynamic dataset and the abbreviation for the dataset from which this phase is taken. Here it is the tc-ds633 dataset from <a href="https://hpxeosandthermocalc.org/" target="_blank"> THERMOCALC </a> (Holland and Powell, 2011). Abbreviations of the phase follow the naming by the authors of the dataset.</li>
        <li>Line 5 is the call to the Gibbs energy function (tl for Thermolab), and here takes the temperature, pressure and phase abbreviation as the minimum input parameters. The output will be Gibbs energy in Joule per mole of phase.</li>
    </ul>
        <h1>Example 2</h1>
        <p>
            <a href="Example_02.m"> <img src="Example_2.PNG" alt="Code" width="100%" style="border:1px solid #ff0000" /></a>
        </p>

        <p>
            A small modification of Example 1 to calculate Gibbs energy of multiple phases for a list of temperatures (T) pressures (P).
        </p>
        <ul>
            <li> Line 2: Creates list of 30 linearly spaced temperatures from 300 to 1000 &deg;C. </li>
            <li> Line 3: Similar to Line 2, for pressures from 0.1 to 4 GPa. </li>
            <li> Line 4: Add more phases to the list separated by comma's.   </li>
            <li> Line 5: Creates grid of P-T points (this is similar to looping over domain of discrete P-T points, see loop version <a href="Example_02_loop.m"> here</a>.) </li>
            <li> Line 6: T and P are input into tl_gibbs_energy as two vectors of P-T coordinates. </li>
        </ul>
        <p>
            Exercise: Plot coesite-quartz reaction. Add other SiO<sub>2</sub> polymorphs.
        </p>

        <h1>Example 3</h1>
        <p>
            <a href="Example_03.m"> <img src="Example_3.PNG" alt="Code" width="100%" style="border:1px solid #ff0000" /></a>
        </p>

        <p>
            Calculate Gibbs energy of multiple phases including solid solutions for a list of temperatures (T) pressures (P).
        </p>
        <ul>
            <li> Line 4: Add more phases to the list separated by comma's. Minerals that form a solid solution use naming as defined in the sheetnames of the solution model Excel file.</li>
            <li> Line 5: Select components in the system using the symbols of the periodic table of elements</li>
            <li> Line 6: Initialize thermodynamic data. This function creates a MATLAB structure array "td" which contains all static information of thermodynamic data for each phase in the list. The third input parameter into this function is the name of the Excel file that holds the solution model file. To find which solution models are available, open this Excel file and look for the names of the Excel sheets.</li>
            <li> Line 8: Calculate Gibbs energy using additional input variable "td". Multiple output variables can be obtained from the function: the gibbs energy, the composition of the discrete phase compounds of the solid solutions and an identifier of each discrete phase compound in the list. The indexing follows the order of the phases in the list in line 4. For example, if there are 15 discrete compositions of Olivine produced, then there will be 15 Olivine Gibbs energies (for each P-T), and the pc_id list will start with 15 '1's, followed by the Orthopyroxene phase compounds etc. The first 15 Gibbs energies in the list then correspond to Olivine with different composition, which can be found in the first 15 compositions in the Npc array.</li>
        </ul>
        <h1>References</h1>

        <div id="biblio">
            <ul>
                <li class="title">An improved and extended internally consistent thermodynamic dataset for phases of petrological interest, involving a new equation of state for solids</li>
                <li class="author_date">Holland, T. J. B. and Powell, R. (2011)</li>
                <li class="journal">Journal of Metamorphic Geology,<b>29</b>, 3, p. 333-383, <a href="https://doi.org/10.1111/j.1525-1314.2010.00923.x" target="_blank"> https://doi.org/10.1111/j.1525-1314.2010.00923.x</a></li>
            </ul>
        </div>
</div>
</body>
</html>
